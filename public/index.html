<!DOCTYPE html>
<html>
	<head>
		<script src='http://code.jquery.com/jquery-1.9.1.min.js'></script>
		<style>

			html, body, div, span, applet, object, iframe,
			h1, h2, h3, h4, h5, h6, p, blockquote, pre,
			a, abbr, acronym, address, big, cite, code,
			del, dfn, em, img, ins, kbd, q, s, samp,
			small, strike, strong, sub, sup, tt, var,
			b, u, i, center,
			dl, dt, dd, ol, ul, li,
			fieldset, form, label, legend,
			table, caption, tbody, tfoot, thead, tr, th, td,
			article, aside, canvas, details, embed, 
			figure, figcaption, footer, header, hgroup, 
			menu, nav, output, ruby, section, summary,
			time, mark, audio, video {
				margin: 0;
				padding: 0;
				border: 0;
				font-size: 100%;
				font: inherit;
				vertical-align: baseline;
			}

			body {
				font-family: "Lucida Console", Monaco, monospace;
				background-color: #ebebe0;
			}

			form {
				text-align: center;
			}

			input {
				font-family: "Lucida Console", Monaco, monospace;
				font-size: 2.65em;
				text-align: center;
				letter-spacing: 6px;
				color: #e60000;

				height: 54px;
				width: 400px;
				border: 1px solid black;
				border-radius: 3px;
			}

			td {
				background-color: white;
				height: 50px;
				width: 50px;
				border: 3px hidden #f4f4f0;
				border-radius: 9px;
			}

			.full {
				background-color: #e60000;
			}

			.half {
				background-color: #ff9999;
			}

			.won {
				background-color: #00cc00;
			}

			.container {
				margin-top: 9%;
			}

			#feedback {
				margin-top: 1.1%;
				margin-left: auto;
				margin-right: auto;
				text-align: center;
				border-spacing: 8px;
			}

			#title {
				text-align: center;
				font-size: 5.7em;
			}

			#newgame, #guess {
				text-align: center;
				font-size: 2.3em;
				letter-spacing: .08em;

				background-color: white;
				border: 1px solid black;
				border-radius: 3px;
				height: 49px;
				width: 31%;
				padding-top: 4px;
				margin-top: 1.9%;
				margin-left: auto;
				margin-right: auto;
			}

			#guess {
				width: 21.5%;
			}

			#guessform{
				margin-top: 2%;
			}

		</style>
	<head>
	<body>

		<div class="container">
			<div id="title">wor<span style="color:#e60000">db</span>reaker</div>
			<div id="newgame"> make new game </div>
			<form id="guessform">
					<input type="text" maxlength="8" value="">
			</form> 
			<div id="guess"> guess </div>
			<table id="feedback"></table>
		</div>

		<script>

			var gameID = function(set) { 
				var id = set;
				return function(set){
					if(set) {
						return id = set;
					} else {
						return id;
					}
				}; 
			}();

			$("#newgame").click(function() {
	      $.ajax({url: "new", success: function(result) {
	      	$.ajax({url: gameID(result) +'/asdf', success: function(result) {
			      $("#newgame").html(result.letters + ' letter word');
			     	$("input").attr("maxlength", result.letters);
			      displayFeedback(result.letters, 0, 0);
			  	}});
		  	}});
			});
		
			$('#guess').click(function () {
				var form = document.getElementById('guessform');
				var input = form.elements[0].value;	
				$.ajax({url: gameID() +'/' + input, success: function(result) {
					if (result.gameOver) winner(result.letters);
					else displayFeedback(result.letters, result.full, result.half);
		  	}});
			});

			function winner(letters) {
				$('#feedback').html('');
				for (i=0; i<letters; i++) {
					$('#feedback').append('<td class="won"></td>');
				}
				$("#newgame").html('make new game');
			}

			function displayFeedback(letters, full, half) {
				$('#feedback').html('');
				var empty = letters - (half + full);
				for (i=0; i<full; i++) {
					$('#feedback').append('<td class="full"></td>');
				}
				for (i=0; i<half; i++) {
					$('#feedback').append('<td class="half"></td>');
				}
				for (i=0; i<empty; i++) {
					$('#feedback').append('<td class="empty"></td>');
				}
			}

		</script>
	</body>
</html>

